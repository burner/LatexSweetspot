\usepackage{color}
\usepackage{xcolor}
\definecolor{mauve}{rgb}{0.86, 0.82, 1.0}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\usepackage{listings}
\usepackage{algorithm}
\usepackage{algpseudocode}  
\usepackage{algorithmicx}
\usepackage{amsthm}
\usepackage{thmtools}
\newtheorem{defn}{Definition}[section]

% This package allows us to figures and tex files separately
\usepackage{standalone}

\lstdefinelanguage{d}{
	morekeywords={abstract,alias,align,asm,assert,auto,body,bool,break,byte,
		case,cast,catch,cdouble,cent,cfloat,char,class,const,continue,creal,
		dchar,debug,default,delegate,delete,deprecated,do,double,else,enum,
		export,extern,false,final,finally,float,for,foreach,foreach_reverse,
		function,goto,idouble,if,ifloat,immutable,import,in,inout,int,
		interface,invariant,ireal,is,lazy,long,macro,mixin,module,new,nothrow,
		null,out,override,package,pragma,private,protected,public,pure,real,
		ref,return,scope,shared,short,static,struct,string,wstring,dstring,
		super,switch,synchronized,template,this,throw,true,try,typedef,typeid,
		typeof,ubyte,ucent,uint,ulong,union,unittest,ushort,version,void,
		volatile,wchar,while,with,size_t,hash_t
	},
	sensitive=True,
	morecomment=[l]{//},
	morecomment=[s]{/\*}{\*/},
	morestring=[b]"
}

\lstdefinestyle{dlang}{
	language=d,
	basicstyle=\footnotesize\ttfamily, % Standardschrift
	numbers=left,               % Ort der Zeilennummern
	numberstyle=\tiny,          % Stil der Zeilennummern
	%stepnumber=2,               % Abstand zwischen den Zeilennummern
	captionpos=b,
	numbersep=5pt,              % Abstand der Nummern zum Text
	tabsize=4,                  % Groesse von Tabs
	extendedchars=true,         %
	breaklines=true,            % Zeilen werden Umgebrochen
	showspaces=false,           % Leerzeichen anzeigen ?
	showtabs=false,             % Tabs anzeigen ?
	%frame=b,
	rulecolor=\color[cmyk]{0.0, 0.0, 0.0, 0.316},
	xleftmargin=+10pt,
	xrightmargin=-00pt,
	%xleftmargin=0pt,
	framexleftmargin=-00pt,
	framexrightmargin=-00pt,
	framexbottommargin=4pt,
	keywordstyle=\color{blue},          % keyword style
	commentstyle=\color{dkgreen},       % comment style
	stringstyle=\color{red},         % string literal style
	showstringspaces=false,    % Leerzeichen in Strings anzeigen ?        
	escapeinside={/+}{+/},
	caption=\lstname,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}
}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[
    backend=biber,
    style=authoryear-icomp,
    sortlocale=de_DE,
    natbib=true,
    url=false, 
    doi=true,
    style=numeric,
    eprint=false,
	backref
]{biblatex}

\usepackage[utf8]{inputenc}
%\usepackage{dtklogos}
\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{mindmap,shadows}
% Information boxes
\newcommand*{\info}[4][16.3]{%
  \node [ annotation, #3, scale=0.65, text width = #1em,
          inner sep = 2mm ] at (#2) {%
  \list{$\bullet$}{\topsep=0pt\itemsep=0pt\parsep=0pt
    \parskip=0pt\labelwidth=8pt\leftmargin=8pt
    \itemindent=0pt\labelsep=2pt}%
    #4
  \endlist
  };
}

% because typing gls takes to long
\usepackage[acronym]{glossaries}
\newcommand{\g}[1]{\gls{#1}}
\newcommand{\G}[1]{\Gls{#1}}
\newcommand{\gp}[1]{\glspl{#1}}
\newcommand{\Gp}[1]{\Glspl{#1}}

\usepackage{stringstrings}

% replacing chapter, section .. paragraph with Chapter, Section will create
% additionally create label of type sec:name_without_blanks
\newcommand{\Chapter}[1]{\chapter{#1} \caselower[e]{#1} \noblanks[e]{\thestring} \label{sec:\thestring}}
\newcommand{\Section}[1]{\section{#1} \caselower[e]{#1} \noblanks[e]{\thestring} \label{sec:\thestring}}
\newcommand{\Subsection}[1]{\subsection{#1} \caselower[e]{#1} \noblanks[e]{\thestring} \label{sec:\thestring}}
\newcommand{\Subsubection}[1]{\subsubsection{#1} \caselower[e]{#1} \noblanks[e]{\thestring} \label{sec:\thestring}}
\newcommand{\Paragraph}[1]{\paragraph{#1} \caselower[e]{#1} \noblanks[e]{\thestring} \label{sec:\thestring}}

\usepackage[english]{babel}
\usepackage[english]{varioref}
\usepackage{hyperref}
\usepackage[english]{cleveref}
\usepackage{ifthen}

\makeatletter
\newcommand*\ifcounter[1]{%
  \ifcsname c@#1\endcsname
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\makeatother

\makeatletter
\def\cref@old@@vpageref#1[#2]#3{%
    \leavevmode%\unskip  <<<
    \global\advance\c@vrcnt\@ne%
    \vref@pagenum\@tempa{\the\c@vrcnt @vr}%
    \vref@pagenum\@tempb{\the\c@vrcnt @xvr}%
    %\vref@label{\the\c@vrcnt @xvr}%  <<<
    \ifx\@tempa\@tempb\else%
      \vref@err{\noexpand\vref or \noexpand\vpageref at page boundary
                \@tempb-\@tempa\space (may loop)%
                }%
    \fi%
    \vrefpagenum\thevpagerefnum{#3}%
    \vref@space%
    \ifx\@tempa\thevpagerefnum%
      \def\@tempc{#1}%
      \ifx\@tempc\@empty%
         \unskip%
      \else%
         #1%
      \fi%
    \else%
      #2%
      \is@pos@number\thevpagerefnum%
         {%
          \is@pos@number\@tempa%
           {\@tempcnta\@tempa%
            \advance\@tempcnta\@ne%
           }%
           {\@tempcnta\maxdimen}%
          \ifnum \thevpagerefnum =\@tempcnta%
           \ifodd\@tempcnta%
             \if@twoside%
               \reftextfaceafter%
             \else%
               \reftextafter%
             \fi%
           \else%
             \reftextafter%
           \fi%
          \else%
            \advance\@tempcnta-2 %  <--- there was a space missing here!
            \ifnum \thevpagerefnum =\@tempcnta%
              \ifodd\@tempcnta%
                \reftextbefore%
              \else%
                \if@twoside%
                  \reftextfacebefore%
                \else%
                  \reftextbefore%
                \fi%
              \fi%
            \else%
              \reftextfaraway{#3}%
            \fi%
          \fi%
         }%
         {\reftextfaraway{#3}}%
    \fi%
    \vref@label{\the\c@vrcnt @xvr}%  <<<
    \vref@label{\the\c@vrcnt @vr}%
  }%
\makeatother

\creflabelformat{equation}{#2#1#3}

% Awesome reference commands
% \Rl = Reference Long (with page hint)
% \Rs = Reference Short (without page hint)
\newcommand{\Rl}[1]{%
\ifcounter{longrefexists#1}{\cref{#1}}{\newcounter{longrefexists#1}\vref{#1}}%
}
\newcommand{\Sl}[2]{%
\ifcounter{longrefexistsline#1}%
	{line \cref{#2} in \cref{#1#2}}%
	{\newcounter{longrefexists#1#2}line \cref{#2} in \cref{#1}}%
}
\newcommand{\SL}[2]{%
\ifcounter{longrefexistsline#1#2}%
	{Line \cref{#2} in \cref{#1}}%
	{\newcounter{longrefexists#1#2}Line \cref{#2} in \cref{#1}}%
}
%\newcommand{\Rl}[1]{\cref{#1}}
\newcommand{\Rs}[1]{\cref{#1}}
%\labelformat{section}{Section~#1}
%\labelformat{subsection}{Section~#1}
%\labelformat{figure}{Figure~#1}
%\labelformat{equation}{Equation~#1}
%\labelformat{listing}{Listing~#1}
%\labelformat{table}{Table~#1}
\crefname{figure}{Figure}{Figures}
\crefname{section}{Section}{Sections}
\crefname{paragraph}{Paragraph}{Paragraphs}
\crefname{table}{Table}{Tables}
\crefname{equation}{Equation}{Equations}
\crefname{algorithm}{Algorithm}{Algorithms}
\crefname{theorem}{Theorem}{Theorems}
\crefname{listing}{Listing}{Listings}

\addto\extrasenglish{%
  \renewcommand{\chapterautorefname}{Chapter}%
}
\addto\extrasenglish{%
  \renewcommand{\sectionautorefname}{Section}%
}

% Glossary file
\input{glossary.gls}

% Acronym file
\input{acronyms.gls}

% Building the indices
\makeindex
\makenoidxglossaries
\usepackage[xindy]{imakeidx}

\newcommand{\listtheorems}{
\renewcommand{\listtheoremname}{List of Theorems}%
\listoftheorems[ignoreall,show={theorems}]
}

\newcommand{\listdefinitions}{
\renewcommand{\listtheoremname}{List of Definitions}%
\listoftheorems[ignoreall,show={defn}]
}
